//ZwSetValueKeyPtr oldZwSetValueKey;
ZwQuerySystemInformationPtr oldZwQuerySystemInformation = NULL;
//ZwOpenProcessPtr oldZwOpenProcess;
//ZwWriteVirtualMemoryPtr oldZwWriteVirtualMemory;
//ZwDebugActiveProcessPtr oldZwDebugActiveProcess;
//ZwCreateSectionPtr oldZwCreateSection;
//ZwCreateProcessPtr oldZwCreateProcess;
//ZwCreateProcessExPtr oldZwCreateProcessEx;
//ZwCreateThreadExPtr oldZwCreateThreadEx;
ZwMapViewOfSectionPtr oldZwMapViewOfSection;
ZwSetContextThreadPtr oldZwSetContextThread;
//ZwSystemDebugControlPtr oldZwSystemDebugControl;
//ZwOpenFilePtr oldZwOpenFile;
//ZwCreateFilePtr oldZwCreateFile;
ZwReadFilePtr oldZwReadFile;
//ZwDeleteFilePtr oldZwDeleteFile;
//ZwSetInformationFilePtr oldZwSetInformationFile;
//ZwCreateMutantPtr oldZwCreateMutant;
ZwDeviceIoControlFilePtr oldZwDeviceIoControlFile;
//ZwTerminateProcessPtr oldZwTerminateProcess;
//ZwLoadDriverPtr oldZwLoadDriver;
ZwDelayExecutionPtr oldZwDelayExecution;
//ZwQueryValueKeyPtr oldZwQueryValueKey;
//ZwQueryAttributesFilePtr oldZwQueryAttributesFile;
//ZwAcceptConnectPortPtr oldZwAcceptConnectPort;
ZwWaitForSingleObjectPtr oldZwWaitForSingleObject;
ZwReplyWaitReceivePortPtr oldZwReplyWaitReceivePort;
ZwRequestWaitReplyPortPtr oldZwRequestWaitReplyPort;
ZwClosePtr oldZwClose;
ZwSetEventPtr oldZwSetEvent;
ZwOpenThreadTokenPtr oldZwOpenThreadToken;
ZwOpenThreadTokenExPtr oldZwOpenThreadTokenEx;
ZwOpenKeyPtr oldZwOpenKey;
ZwAllocateVirtualMemoryPtr oldZwAllocateVirtualMemory;
ZwProtectVirtualMemoryPtr oldZwProtectVirtualMemory;
ZwQueryInformationTokenPtr oldZwQueryInformationToken;
ZwEnumerateKeyPtr oldZwEnumerateKey;
ZwFlushInstructionCachePtr oldZwFlushInstructionCache;
ZwQuerySecurityObjectPtr oldZwQuerySecurityObject;
ZwQueryDefaultLocalePtr oldZwQueryDefaultLocale;
ZwQuerySystemTimePtr oldZwQuerySystemTime;
ZwOpenSectionPtr oldZwOpenSection;
ZwSetInformationProcessPtr oldZwSetInformationProcess;
ZwQueryInformationProcessPtr oldZwQueryInformationProcess;
ZwGetContextThreadPtr oldZwGetContextThread;
ZwCreateProfilePtr oldZwCreateProfile;
ZwStartProfilePtr oldZwStartProfile;
ZwAccessCheckPtr oldZwAccessCheck;
ZwAccessCheckAndAuditAlarmPtr oldZwAccessCheckAndAuditAlarm;
ZwSetSystemInformationPtr oldZwSetSystemInformation;
ZwGetPlugPlayEventPtr oldZwGetPlugPlayEvent;
ZwPlugPlayControlPtr oldZwPlugPlayControl;
ZwLockVirtualMemoryPtr oldZwLockVirtualMemory;
ZwUnlockVirtualMemoryPtr oldZwUnlockVirtualMemory;
ZwFlushVirtualMemoryPtr oldZwFlushVirtualMemory;
ZwAllocateUserPhysicalPagesPtr oldZwAllocateUserPhysicalPages;
ZwFreeUserPhysicalPagesPtr oldZwFreeUserPhysicalPages;
ZwMapUserPhysicalPagesPtr oldZwMapUserPhysicalPages;
ZwMapUserPhysicalPagesScatterPtr oldZwMapUserPhysicalPagesScatter;
ZwGetWriteWatchPtr oldZwGetWriteWatch;
ZwResetWriteWatchPtr oldZwResetWriteWatch;
ZwFreeVirtualMemoryPtr oldZwFreeVirtualMemory;
ZwQueryVirtualMemoryPtr oldZwQueryVirtualMemory;
ZwReadVirtualMemoryPtr oldZwReadVirtualMemory;
ZwWriteVirtualMemoryPtr oldZwWriteVirtualMemory;
ZwCreateFilePtr oldZwCreateFile;
ZwOpenFilePtr oldZwOpenFile;
ZwDeleteFilePtr oldZwDeleteFile;
ZwFlushBuffersFilePtr oldZwFlushBuffersFile;
ZwCancelIoFilePtr oldZwCancelIoFile;
ZwWriteFilePtr oldZwWriteFile;
ZwReadFileScatterPtr oldZwReadFileScatter;
ZwWriteFileGatherPtr oldZwWriteFileGather;
ZwLockFilePtr oldZwLockFile;
ZwUnlockFilePtr oldZwUnlockFile;
ZwFsControlFilePtr oldZwFsControlFile;
ZwNotifyChangeDirectoryFilePtr oldZwNotifyChangeDirectoryFile;
ZwQueryEaFilePtr oldZwQueryEaFile;
ZwSetEaFilePtr oldZwSetEaFile;
ZwCreateNamedPipeFilePtr oldZwCreateNamedPipeFile;
ZwCreateMailslotFilePtr oldZwCreateMailslotFile;
ZwQueryVolumeInformationFilePtr oldZwQueryVolumeInformationFile;
ZwSetVolumeInformationFilePtr oldZwSetVolumeInformationFile;
ZwQueryQuotaInformationFilePtr oldZwQueryQuotaInformationFile;
ZwSetQuotaInformationFilePtr oldZwSetQuotaInformationFile;
ZwQueryAttributesFilePtr oldZwQueryAttributesFile;
ZwQueryFullAttributesFilePtr oldZwQueryFullAttributesFile;
ZwQueryInformationFilePtr oldZwQueryInformationFile;
ZwSetInformationFilePtr oldZwSetInformationFile;
ZwQueryDirectoryFilePtr oldZwQueryDirectoryFile;
ZwCreateKeyPtr oldZwCreateKey;
ZwDeleteKeyPtr oldZwDeleteKey;
ZwFlushKeyPtr oldZwFlushKey;
ZwSaveKeyPtr oldZwSaveKey;
ZwSaveKeyExPtr oldZwSaveKeyEx;
ZwSaveMergedKeysPtr oldZwSaveMergedKeys;
ZwRestoreKeyPtr oldZwRestoreKey;
ZwLoadKeyPtr oldZwLoadKey;
ZwLoadKey2Ptr oldZwLoadKey2;
ZwUnloadKeyPtr oldZwUnloadKey;
ZwUnloadKeyExPtr oldZwUnloadKeyEx;
ZwQueryOpenSubKeysPtr oldZwQueryOpenSubKeys;
ZwReplaceKeyPtr oldZwReplaceKey;
ZwSetInformationKeyPtr oldZwSetInformationKey;
ZwQueryKeyPtr oldZwQueryKey;
ZwNotifyChangeKeyPtr oldZwNotifyChangeKey;
ZwNotifyChangeMultipleKeysPtr oldZwNotifyChangeMultipleKeys;
ZwDeleteValueKeyPtr oldZwDeleteValueKey;
ZwSetValueKeyPtr oldZwSetValueKey;
ZwQueryValueKeyPtr oldZwQueryValueKey;
ZwEnumerateValueKeyPtr oldZwEnumerateValueKey;
ZwQueryMultipleValueKeyPtr oldZwQueryMultipleValueKey;
ZwInitializeRegistryPtr oldZwInitializeRegistry;
ZwCreatePortPtr oldZwCreatePort;
ZwCreateWaitablePortPtr oldZwCreateWaitablePort;
ZwConnectPortPtr oldZwConnectPort;
ZwSecureConnectPortPtr oldZwSecureConnectPort;
ZwListenPortPtr oldZwListenPort;
ZwAcceptConnectPortPtr oldZwAcceptConnectPort;
ZwCompleteConnectPortPtr oldZwCompleteConnectPort;
ZwRequestPortPtr oldZwRequestPort;
ZwReplyPortPtr oldZwReplyPort;
ZwReplyWaitReplyPortPtr oldZwReplyWaitReplyPort;
ZwReplyWaitReceivePortExPtr oldZwReplyWaitReceivePortEx;
ZwReadRequestDataPtr oldZwReadRequestData;
ZwWriteRequestDataPtr oldZwWriteRequestData;
ZwQueryInformationPortPtr oldZwQueryInformationPort;
ZwImpersonateClientOfPortPtr oldZwImpersonateClientOfPort;
ZwCreateProcessPtr oldZwCreateProcess;
ZwCreateProcessExPtr oldZwCreateProcessEx;
ZwOpenProcessPtr oldZwOpenProcess;
ZwTerminateProcessPtr oldZwTerminateProcess;
ZwCreateThreadPtr oldZwCreateThread;
ZwOpenThreadPtr oldZwOpenThread;
ZwTerminateThreadPtr oldZwTerminateThread;
ZwQueryInformationThreadPtr oldZwQueryInformationThread;
ZwSetInformationThreadPtr oldZwSetInformationThread;
ZwSuspendThreadPtr oldZwSuspendThread;
ZwResumeThreadPtr oldZwResumeThread;
ZwQueueApcThreadPtr oldZwQueueApcThread;
ZwTestAlertPtr oldZwTestAlert;
ZwAlertThreadPtr oldZwAlertThread;
ZwAlertResumeThreadPtr oldZwAlertResumeThread;
ZwRegisterThreadTerminatePortPtr oldZwRegisterThreadTerminatePort;
ZwImpersonateThreadPtr oldZwImpersonateThread;
ZwImpersonateAnonymousTokenPtr oldZwImpersonateAnonymousToken;
ZwQuerySystemEnvironmentValuePtr oldZwQuerySystemEnvironmentValue;
ZwQuerySystemEnvironmentValueExPtr oldZwQuerySystemEnvironmentValueEx;
ZwSetSystemEnvironmentValuePtr oldZwSetSystemEnvironmentValue;
ZwSetSystemEnvironmentValueExPtr oldZwSetSystemEnvironmentValueEx;
ZwShutdownSystemPtr oldZwShutdownSystem;
ZwSystemDebugControlPtr oldZwSystemDebugControl;
ZwQueryObjectPtr oldZwQueryObject;
ZwSetInformationObjectPtr oldZwSetInformationObject;
ZwDuplicateObjectPtr oldZwDuplicateObject;
ZwMakeTemporaryObjectPtr oldZwMakeTemporaryObject;
ZwSetSecurityObjectPtr oldZwSetSecurityObject;
ZwCreateDirectoryObjectPtr oldZwCreateDirectoryObject;
ZwOpenDirectoryObjectPtr oldZwOpenDirectoryObject;
ZwQueryDirectoryObjectPtr oldZwQueryDirectoryObject;
ZwCreateSymbolicLinkObjectPtr oldZwCreateSymbolicLinkObject;
ZwOpenSymbolicLinkObjectPtr oldZwOpenSymbolicLinkObject;
ZwQuerySymbolicLinkObjectPtr oldZwQuerySymbolicLinkObject;
ZwCreateSectionPtr oldZwCreateSection;
ZwQuerySectionPtr oldZwQuerySection;
ZwExtendSectionPtr oldZwExtendSection;
ZwUnmapViewOfSectionPtr oldZwUnmapViewOfSection;
ZwAreMappedFilesTheSamePtr oldZwAreMappedFilesTheSame;
ZwCreateJobObjectPtr oldZwCreateJobObject;
ZwOpenJobObjectPtr oldZwOpenJobObject;
ZwTerminateJobObjectPtr oldZwTerminateJobObject;
ZwAssignProcessToJobObjectPtr oldZwAssignProcessToJobObject;
ZwQueryInformationJobObjectPtr oldZwQueryInformationJobObject;
ZwSetInformationJobObjectPtr oldZwSetInformationJobObject;
ZwCreateTokenPtr oldZwCreateToken;
ZwOpenProcessTokenPtr oldZwOpenProcessToken;
ZwOpenProcessTokenExPtr oldZwOpenProcessTokenEx;
ZwDuplicateTokenPtr oldZwDuplicateToken;
ZwFilterTokenPtr oldZwFilterToken;
ZwAdjustPrivilegesTokenPtr oldZwAdjustPrivilegesToken;
ZwAdjustGroupsTokenPtr oldZwAdjustGroupsToken;
ZwSetInformationTokenPtr oldZwSetInformationToken;
ZwSignalAndWaitForSingleObjectPtr oldZwSignalAndWaitForSingleObject;
ZwWaitForMultipleObjectsPtr oldZwWaitForMultipleObjects;
ZwCreateTimerPtr oldZwCreateTimer;
ZwOpenTimerPtr oldZwOpenTimer;
ZwCancelTimerPtr oldZwCancelTimer;
ZwSetTimerPtr oldZwSetTimer;
ZwQueryTimerPtr oldZwQueryTimer;
ZwCreateEventPtr oldZwCreateEvent;
ZwOpenEventPtr oldZwOpenEvent;
ZwPulseEventPtr oldZwPulseEvent;
ZwResetEventPtr oldZwResetEvent;
ZwClearEventPtr oldZwClearEvent;
ZwQueryEventPtr oldZwQueryEvent;
ZwCreateSemaphorePtr oldZwCreateSemaphore;
ZwOpenSemaphorePtr oldZwOpenSemaphore;
ZwReleaseSemaphorePtr oldZwReleaseSemaphore;
ZwQuerySemaphorePtr oldZwQuerySemaphore;
ZwCreateMutantPtr oldZwCreateMutant;
ZwOpenMutantPtr oldZwOpenMutant;
ZwReleaseMutantPtr oldZwReleaseMutant;
ZwQueryMutantPtr oldZwQueryMutant;
ZwCreateIoCompletionPtr oldZwCreateIoCompletion;
ZwOpenIoCompletionPtr oldZwOpenIoCompletion;
ZwSetIoCompletionPtr oldZwSetIoCompletion;
ZwRemoveIoCompletionPtr oldZwRemoveIoCompletion;
ZwQueryIoCompletionPtr oldZwQueryIoCompletion;
ZwCreateEventPairPtr oldZwCreateEventPair;
ZwOpenEventPairPtr oldZwOpenEventPair;
ZwWaitLowEventPairPtr oldZwWaitLowEventPair;
ZwWaitHighEventPairPtr oldZwWaitHighEventPair;
ZwSetLowWaitHighEventPairPtr oldZwSetLowWaitHighEventPair;
ZwSetHighWaitLowEventPairPtr oldZwSetHighWaitLowEventPair;
ZwSetLowEventPairPtr oldZwSetLowEventPair;
ZwSetHighEventPairPtr oldZwSetHighEventPair;
ZwSetSystemTimePtr oldZwSetSystemTime;
ZwQueryPerformanceCounterPtr oldZwQueryPerformanceCounter;
ZwSetTimerResolutionPtr oldZwSetTimerResolution;
ZwQueryTimerResolutionPtr oldZwQueryTimerResolution;
ZwYieldExecutionPtr oldZwYieldExecution;
ZwSetIntervalProfilePtr oldZwSetIntervalProfile;
ZwQueryIntervalProfilePtr oldZwQueryIntervalProfile;
ZwStopProfilePtr oldZwStopProfile;
ZwPrivilegeCheckPtr oldZwPrivilegeCheck;
ZwPrivilegeObjectAuditAlarmPtr oldZwPrivilegeObjectAuditAlarm;
ZwPrivilegedServiceAuditAlarmPtr oldZwPrivilegedServiceAuditAlarm;
ZwAccessCheckByTypePtr oldZwAccessCheckByType;
ZwAccessCheckByTypeAndAuditAlarmPtr oldZwAccessCheckByTypeAndAuditAlarm;
ZwAccessCheckByTypeResultListPtr oldZwAccessCheckByTypeResultList;
ZwAccessCheckByTypeResultListAndAuditAlarmPtr oldZwAccessCheckByTypeResultListAndAuditAlarm;
ZwAccessCheckByTypeResultListAndAuditAlarmByHandlePtr oldZwAccessCheckByTypeResultListAndAuditAlarmByHandle;
ZwOpenObjectAuditAlarmPtr oldZwOpenObjectAuditAlarm;
ZwCloseObjectAuditAlarmPtr oldZwCloseObjectAuditAlarm;
ZwDeleteObjectAuditAlarmPtr oldZwDeleteObjectAuditAlarm;
ZwRequestWakeupLatencyPtr oldZwRequestWakeupLatency;
ZwRequestDeviceWakeupPtr oldZwRequestDeviceWakeup;
ZwCancelDeviceWakeupRequestPtr oldZwCancelDeviceWakeupRequest;
ZwIsSystemResumeAutomaticPtr oldZwIsSystemResumeAutomatic;
ZwSetThreadExecutionStatePtr oldZwSetThreadExecutionState;
ZwGetDevicePowerStatePtr oldZwGetDevicePowerState;
ZwSetSystemPowerStatePtr oldZwSetSystemPowerState;
ZwInitiatePowerActionPtr oldZwInitiatePowerAction;
ZwPowerInformationPtr oldZwPowerInformation;
ZwRaiseExceptionPtr oldZwRaiseException;
//ZwContinuePtr oldZwContinue;
ZwCallbackReturnPtr oldZwCallbackReturn;
ZwLoadDriverPtr oldZwLoadDriver;
ZwUnloadDriverPtr oldZwUnloadDriver;
ZwFlushWriteBufferPtr oldZwFlushWriteBuffer;
ZwSetDefaultLocalePtr oldZwSetDefaultLocale;
ZwQueryDefaultUILanguagePtr oldZwQueryDefaultUILanguage;
ZwSetDefaultUILanguagePtr oldZwSetDefaultUILanguage;
ZwQueryInstallUILanguagePtr oldZwQueryInstallUILanguage;
ZwAllocateLocallyUniqueIdPtr oldZwAllocateLocallyUniqueId;
ZwAllocateUuidsPtr oldZwAllocateUuids;
ZwSetUuidSeedPtr oldZwSetUuidSeed;
ZwRaiseHardErrorPtr oldZwRaiseHardError;
ZwSetDefaultHardErrorPortPtr oldZwSetDefaultHardErrorPort;
ZwDisplayStringPtr oldZwDisplayString;
ZwCreatePagingFilePtr oldZwCreatePagingFile;
ZwAddAtomPtr oldZwAddAtom;
ZwFindAtomPtr oldZwFindAtom;
ZwDeleteAtomPtr oldZwDeleteAtom;
ZwQueryInformationAtomPtr oldZwQueryInformationAtom;
ZwSetLdtEntriesPtr oldZwSetLdtEntries;
ZwVdmControlPtr oldZwVdmControl;
NtSetBootEntryOrderPtr oldNtSetBootEntryOrder;
NtCompactKeysPtr oldNtCompactKeys;
NtCompareTokensPtr oldNtCompareTokens;
NtCompressKeyPtr oldNtCompressKey;
NtCreateDebugObjectPtr oldNtCreateDebugObject;
NtCreateJobSetPtr oldNtCreateJobSet;
NtDebugActiveProcessPtr oldNtDebugActiveProcess;
NtDebugContinuePtr oldNtDebugContinue;
NtEnumerateSystemEnvironmentValuesExPtr oldNtEnumerateSystemEnvironmentValuesEx;
NtIsProcessInJobPtr oldNtIsProcessInJob;
NtLockProductActivationKeysPtr oldNtLockProductActivationKeys;
NtLockRegistryKeyPtr oldNtLockRegistryKey;
NtMakePermanentObjectPtr oldNtMakePermanentObject;
NtDeleteBootEntryPtr oldNtDeleteBootEntry;
NtQueryDebugFilterStatePtr oldNtQueryDebugFilterState;
NtRemoveProcessDebugPtr oldNtRemoveProcessDebug;
NtRenameKeyPtr oldNtRenameKey;
NtResumeProcessPtr oldNtResumeProcess;
NtSetDebugFilterStatePtr oldNtSetDebugFilterState;
NtSetEventBoostPriorityPtr oldNtSetEventBoostPriority;
NtSetInformationDebugObjectPtr oldNtSetInformationDebugObject;
NtSuspendProcessPtr oldNtSuspendProcess;
NtTraceEventPtr oldNtTraceEvent;
NtTranslateFilePathPtr oldNtTranslateFilePath;
NtWaitForDebugEventPtr oldNtWaitForDebugEvent;
NtCreateKeyedEventPtr oldNtCreateKeyedEvent;
NtOpenKeyedEventPtr oldNtOpenKeyedEvent;
NtReleaseKeyedEventPtr oldNtReleaseKeyedEvent;
NtWaitForKeyedEventPtr oldNtWaitForKeyedEvent;
NtQueryPortInformationProcessPtr oldNtQueryPortInformationProcess;